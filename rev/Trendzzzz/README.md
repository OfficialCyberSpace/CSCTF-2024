## Trendzzzz (Part 4)

This is part 4 of the Trendz series, to get the binary you had to go to `/static../chall`, after reversing it you will find that one function was not present in the source code, you had to reverse it and send a CONNECT request that caused a 404 error along with a specific header, the response will contain the flag.

```python
from z3 import *
s = Solver()
array=[BitVec(f"v_{i}",255) for i in range(32)]
s.add(array[0] + array[21] == 114)
s.add(array[1] * array[16] == 11413)
s.add(array[2] + array[11] == 174)
s.add(array[3] + array[9] == 157)
s.add(array[4] ^ array[2] == 78)
s.add(array[5] + array[19] == 155)
s.add(array[6] + array[24] == 142)
s.add(array[7] * array[21] == 3080)
s.add(array[8] - array[28] == 72)
s.add(array[9] - array[31] == -47)
s.add(array[10] + array[9] == 165)
s.add(array[11] * array[6] == 3920)
s.add(array[12] ^ array[6] == 15)
s.add(array[13] - array[14] == -48)
s.add(array[14] ^ array[21] == 26)
s.add(array[15] * array[16] == 12726)
s.add(array[16] * array[13] == 3939)
s.add(array[17] - array[31] == 31)
s.add(array[18] + array[29] == 82)
s.add(array[19] * array[2] == 5928)
s.add(array[20] + array[6] == 109)
s.add(array[21] * array[30] == 3696)
s.add(array[22] - array[24] == -32)
s.add(array[23] + array[27] == 201)
s.add(array[24] - array[4] == 48)
s.add(array[25] - array[6] == 51)
s.add(array[26] - array[10] == -18)
s.add(array[27] + array[12] == 159)
s.add(array[28] ^ array[3] == 95)
s.add(array[29] - array[9] == 29)
s.add(array[30] ^ array[26] == 87)
s.add(array[31] + array[4] == 129)
s.add(array[20] + array[10] == 174)
s.add(array[11] ^ array[16] == 35)
s.add(array[4] * array[23] == 3686)
s.add(array[3] * array[26] == 11639)
s.add(array[31] ^ array[12] == 108)
s.add(array[12] * array[30] == 2640)
s.add(array[20] * array[14] == 4611)
s.add(array[10] ^ array[19] == 64)
s.add(array[0] + array[23] == 134)
s.add(array[9] - array[12] == -11)
s.add(array[4] * array[19] == 2166)
s.add(array[15] ^ array[8] == 8)
s.add(array[15] ^ array[11] == 56)
s.add(array[22] * array[2] == 5616)
s.add(array[19] ^ array[24] == 111)
s.add(array[0] + array[16] == 138)
s.add(array[18] * array[16] == 909)
s.add(array[29] * array[15] == 9198)
s.add(array[9] + array[27] == 148)
s.add(array[20] * array[0] == 1961)
s.add(array[8] + array[15] == 244)
s.add(array[23] + array[30] == 145)
s.add(array[19] * array[12] == 3135)
s.add(array[26] * array[8] == 12154)
s.add(array[2] ^ array[0] == 77)
s.add(array[12] - array[19] == -2)
s.add(array[19] ^ array[24] == 111)
s.add(array[22] - array[28] == 8)
s.check()
a=s.model()
from base64 import b64encode
print(b64encode(bytes([a[i].as_long() for i in array])))
```

`curl -X CONNECT https://<Domain>/lmao -H 'X-Super-Secret: JXFocSZiOCh2LHlGNydXfmV6CTk1TTZhVmtnaC5JMFs='`
